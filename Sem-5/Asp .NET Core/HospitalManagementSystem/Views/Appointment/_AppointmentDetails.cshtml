@model Appointment
@using HospitalManagementSystem.Utilities

@if (Model != null)
{
    var statusClass = "secondary";
    var statusIcon = "bx-question-mark";
    switch (Model.AppointmentStatus?.ToLower())
    {
        case "scheduled":
            statusClass = "primary";
            statusIcon = "bx-time-five";
            break;
        case "completed":
            statusClass = "success";
            statusIcon = "bx-check-circle";
            break;
        case "cancelled":
            statusClass = "danger";
            statusIcon = "bx-x-circle";
            break;
        case "no-show":
            statusClass = "warning";
            statusIcon = "bx-error-circle";
            break;
    }

    <div>
        <div class="row text-center text-md-start">
            <div class="col-md-6 d-flex align-items-center">
                <i class='bx bxs-user-circle text-primary me-3' style="font-size: 3rem;"></i>
                <div>
                    <small class="text-muted">Patient</small>
                    <h5 class="mb-0">@Model.Patient.Name</h5>
                    <a href="mailto:@Model.Patient.Email" class="text-decoration-none">@Model.Patient.Email</a>
                </div>
            </div>
            <div class="col-md-6 d-flex align-items-center mt-3 mt-md-0">
                <i class='fa-solid fa-stethoscope fs-2 text-info me-2'></i>
                <div>
                    <small class="text-muted">Doctor</small>
                    <h5 class="mb-0">@Model.Doctor.Name</h5>
                    <span class="text-muted">@Model.Doctor.Specialization</span>
                </div>
            </div>
        </div>

        <hr class="my-4" />

        <div class="bg-light p-3 rounded">
            <div class="row align-items-center">
                <div class="col-md-5 d-flex align-items-center">
                    <i class='bx bx-calendar-alt text-primary me-3' style="font-size: 2.5rem;"></i>
                    <div>
                        <small class="text-muted">Date</small>
                        <h5 class="mb-0">@Model.AppointmentDate.ToString("ddd, dd MMM yyyy")</h5>
                    </div>
                </div>

                <div class="col-md-4 d-flex align-items-center mt-3 mt-md-0">
                    <i class='bx bx-time text-info me-3' style="font-size: 2.5rem;"></i>
                    <div>
                        <small class="text-muted">Time</small>
                        <h5 class="mb-0">@Model.AppointmentDate.ToString("hh:mm tt")</h5>
                    </div>
                </div>

                <div class="col-md-3 text-md-end mt-3 mt-md-0">
                    <span class="badge bg-label-@statusClass fs-6">
                        <i class='bx @statusIcon me-1'></i> @Model.AppointmentStatus
                    </span>
                </div>
            </div>
        </div>


        <div class="mt-4">
            @if (!string.IsNullOrEmpty(Model.Description))
            {
                <div class="mb-3">
                    <strong>Description:</strong>
                    <p class="text-muted fst-italic">"@Model.Description"</p>
                </div>
            }
            @if (!string.IsNullOrEmpty(Model.SpecialRemarks))
            {
                <div class="mb-3">
                    <strong>Special Remarks:</strong>
                    <p class="text-muted fst-italic">"@Model.SpecialRemarks"</p>
                </div>
            }
            <div class="d-flex justify-content-between align-items-center border-top pt-3">
                <h5 class="mb-0">Consultation Fee:</h5>
                <h5 class="mb-0 text-success">@Model.TotalConsultedAmount.ToString("C")</h5>
            </div>
        </div>

        <div class="d-flex justify-content-between align-items-center border-top mt-4 pt-3">
            <small class="text-muted">
                Last updated: @Model.Modified.ToString("g")
            </small>
            <div>
                <a class="btn btn-primary" asp-controller="Appointment" asp-action="Edit" asp-route-id="@UrlEncryptor.Encrypt(Model.AppointmentID.ToString())">
                    <i class="bx bx-edit-alt me-1"></i> Edit
                </a>
            </div>
        </div>

    </div>
}
else
{
    <div class="alert alert-danger">
        Could not load appointment details. Please try again.
    </div>
}